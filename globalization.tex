\chapter{Globalization}

\section{4-point condition}

A quadruple of points $p,x,y,z$ in a metric space $\spc{X}$ satisfies 
$\CBB{}{0}$ comparison if
\[\angk pxy_{\EE^2}+\angk pyz_{\EE^2}+\angk pzx_{\EE^2}\le 2\cdot\pi.\]
If $p$ coincides with one of the points $x$, $y$ or $z$ then the left hand side is undefined;
in this case we assume that $\CBB{}{0}$ comparison holds automatically.

Taking hyperbolic plane $\HH^2$ or sphere $\SS^2$ instead of the Eulcidean plane $\EE^2$,
one defines $\CBB{}{-1}$ and $\CBB{}{1}$ comparison.
\begin{itemize}
\item We say that a quadruple $p,x,y,z$ in $\spc{X}$ satisfies 
$\CBB{}{-1}$ comparison if 
\[\angk pxy_{\HH^2}+\angk pyz_{\HH^2}+\angk pzx_{\HH^2}\le 2\cdot\pi.\]
\item We say that a quadruple $p,x,y,z$ in $\spc{X}$ satisfies
$\CBB{}{1}$ comparison if 
\[\angk pxy_{\SS^2}+\angk pyz_{\SS^2}+\angk pzx_{\SS^2}\le 2\cdot\pi.\]
\end{itemize}
In the latter case the left hand side is undefined if $p$ coincides with 
one of $x$, $y$ or $z$ or one of the comparison triangles $\modtrig(pxy)_{\SS^2}$, $\modtrig(pyz)_{\SS^2}$ or $\modtrig(pzx)_{\SS^2}$ is undefined\footnote{That is 
\begin{align*}
\dist{p}{x}{}+\dist{p}{y}{}+\dist{x}{y}{}&\ge2\cdot\pi,\quad\text{or}
\\
\dist{p}{y}{}+\dist{p}{z}{}+\dist{y}{z}{}&\ge2\cdot\pi,\quad\text{or}
\\
\dist{p}{z}{}+\dist{p}{x}{}+\dist{z}{x}{}&\ge2\cdot\pi.
\end{align*}
};
in these cases we also assume that $\CBB{}{0}$ comparison holds automatically.

We say that a metric space $\spc{L}$ is $\CBB{}{\kappa}$ if all quadruples of points in $\spc{L}$ satisfy $\CBB{}{\kappa}$ comparison.

In the definition of spaces with curvature $\CBB{}{1}$, 
most authors assume in addition that $\diam \spc{L}\le \pi$. 
We do not make this assumption. 
In particular, the real line is a $\CBB{}{1}$ space for us.


\begin{thm}{Exercise}
Let $\spc{L}$ be a length space.
Show that $\spc{L}$ is a $\CBB{}0$ space
if and only if 
\[
\area\modtrig(xyz)_{\EE^2}
\le
\area\modtrig(pxy)_{\EE^2}+\area\modtrig(pyz)_{\EE^2}+\area\modtrig(pzx)_{\EE^2}
\]
for any 4 distinct points $p,x,y,z\in\spc{L}$.
\end{thm}

\begin{thm}{Exercise}\label{mink+alex=euclid} 
Assume that the metric $\rho$ on  $\RR^m$ is defined by a norm.
Show that $(\RR^m,\rho)$ is a $\CBB{}0$ space if and only if it is isometric to the Euclidean space.
\end{thm}

\section{Hinge comparison}


Now we are ready to give a number of equivalent definitions of Alexandrov space:

\begin{thm}{Theorem}
\label{thm:defs_of_alex} 
Let $\spc{L}$ be a complete length space. 
Then

\begin{subthm}{3-sum} $\spc{L}\in\CBB{}{\kappa}$
\end{subthm}
if and only if $\spc{L}$ is G-delta geodesic and one of the following conditions holds for all $p,x,y\in \spc{L}$, once $\modtrig\kappa(p x y)$ is defined:

\begin{subthm}{2-sum} 
(adjacent angle comparison\index{comparison!adjacent angle comparison}) for any geodesic $[x y]$ and $z\in \l]x y\r[$, $z\not=p$ we have
\[\angk z p x
+\angk z p y\le \pi.\]
\end{subthm}

\begin{subthm}{point-on-side}
(point-on-side comparison%
\index{point-on-side comparison})
for any geodesic $[x y]$ and $z\in \l]x y\r[$, we have
\[\angk x p y\le\angk x p z;\]
or, equivalently, 
\[\dist{\~p}{\~z}{}\le \dist{p}{z}{},\]
where $\trig{\~p}{\~x}{\~y}=\modtrig\kappa(p x y)$, $\~z\in\l] \~x\~y\r[$, $\dist{\~x}{\~z}{}=\dist{x}{z}{}$.
\end{subthm}

\begin{subthm}{angle}(hinge comparison\index{hinge comparison})
for any hinge $\hinge x p y$, the angle 
$\mangle\hinge x p y$ is defined and 
\[\mangle\hinge x p y\ge\angk x p y,\]
or equivalently
\[\side\kappa \hinge x p y\ge\dist{p}{y}{}.\]
Moreover, if $z\in\l]x y\r[$, $z\not=p$ then 
\[\mangle\hinge z p y + \mangle\hinge z p x\le\pi\]
for any two hinges $\hinge z p y$ and $\hinge z p x$ with common side $[z p]$.
\end{subthm}
\end{thm}

\parbf{Remarks.} 
The monotonicity of model angle with respect to adjacent sidelengths (\ref{SHORT.two-mono-cba}) was named the \emph{convexity property} by Alexandrov.
%???REF???

A bit weaker form of (\ref{SHORT.angle}) 
is given in \ref{lem:devel-glob}.
See also Problem~\ref{open:hinge-}.


\parit{Proof.} By Theorem~\ref{thm:almost.geod}, 
we have that (\ref{SHORT.3-sum}) imples that $\spc{L}$ is G-delta geodesic.

\parit{(\ref{SHORT.3-sum}) $\Rightarrow$ (\ref{SHORT.2-sum})}. Since $z\in \l]x y\r[$, we have $\angk z x y=\pi$. 
Thus, (1+3)-point comparison
\[\angk z x y
+\angk z p x
+\angk z p y\le2\cdot\pi\]
implies
\[\angk z p x
+\angk z p y
\le\pi.\]

\parit{(\ref{SHORT.2-sum}) $\Leftrightarrow$ (\ref{SHORT.point-on-side})}. 
Follows directly from Alexandrov's lemma (\ref{lem:alex}).

\parit{(\ref{SHORT.2-sum}) $+$ (\ref{SHORT.point-on-side}) $\Rightarrow$ (\ref{SHORT.angle}).} 
From (\ref{SHORT.point-on-side}) we get that for $\bar p\in\l]xp\r]$ and $\bar y\in\l]xy\r]$ the function $(\dist{x}{\bar p}{},\dist{x}{\bar y}{})\mapsto\angk x{\bar p}{\bar y}$ is nonincreasing in each argument.
In particular, 
$\mangle\hinge x p y\z=\sup\{\angk x{\bar p}{\bar y}\}$.
Thus, $\mangle\hinge x p y$ is defined and it is
at least $\angk x p y$.

From above and (\ref{SHORT.2-sum}), it follows that $\mangle\hinge z p y + \mangle\hinge z p x\le\pi$.

\begin{wrapfigure}[10]{r}{30mm}
\begin{lpic}[t(0mm),b(0mm),r(0mm),l(0mm)]{pics/angle-comp(0.30)}
\lbl[r]{0,35;$z$}
\lbl[l]{65,41;$p$}
\lbl[tr]{48,38;$w$}
\lbl[lb]{77,96;$x$}
\lbl[lt]{85,4;$y$}
\end{lpic}
\end{wrapfigure}

\parit{(\ref{SHORT.angle}) $\Rightarrow$ (\ref{SHORT.3-sum}).}
Assume first that $\spc{L}$ is geodesic.
Consider point $w\in \l] p z \r[$ close to $p$.
From (\ref{SHORT.angle}), it follows that 
\[\mangle\hinge w x z+ \mangle\hinge w x{p}\le\pi\ \ \text{and}\ \ \mangle\hinge w y z + \mangle\hinge w y{p}\le\pi.\]
Since $\mangle\hinge w x y\le \mangle\hinge w x p +\mangle\hinge w y{p}$ (see \ref{claim:angle-3angle-inq}), we get 
\[\mangle\hinge w x z+ \mangle\hinge w y z +\mangle\hinge w x y
\le
2\cdot\pi.\]
Applying the first inequality in (\ref{SHORT.angle}), we obtain
\[\angk w x z
+ \angk w y z 
+\angk w x y
\le
2\cdot\pi.\]
Passing to the limits  $w\to p$, we obtain 
\[\angk p x z 
+ \angk p y z 
+\angk p x y
\le
2\cdot\pi.\]

Finally, if $\spc{L}$ is not geodesic, we can apply above arguments for sequences of points $p_n,w_n\to p$, $p_n\in \Str(z)$, $w_n\in\l]z p_n\r[$ and $x_n\to x$, $y_n\to y$, $x_n,y_n\in \Str(w_n)$.
\qeds


\begin{thm}{Angle-sidelength  monotonicity}\label{cor:monoton} 
Let $\spc{L}\in\CBB{}{\kappa}$,
$p,x,y\in \spc{L}$,
$\modtrig\kappa(p x y)$ is defined
and there is a geodesic $[xy]$.
Then for $\bar y\in\l]xy\r]$ the function 
\[\dist{x}{\bar y}{}\mapsto \angk x p{\bar y}\] 
is nonincreasing.

In particular, if geodesic $[x p]$ exists and $\bar p\in \l]x p\r]$ then
\begin{subthm}{cor:monoton:2-sides}
the function 
\[(\dist{x}{\bar y}{},\dist{x}{\bar p}{})\mapsto \angk x {\bar p}{\bar y}\] is nonincresing in each argument
\end{subthm}
 
\begin{subthm}{cor:monoton:sup}
The angle $\mangle\hinge{x}{p}{y}$ is defined and 
\[\mangle\hinge{x}{p}{y}
=
\sup\set{\angk x {\bar p}{\bar y}}{
\bar p\in\l]xp\r],\ 
\bar y\in\l]xy\r]}.\]

\end{subthm}
\end{thm}

\parit{Proof.}
See the first part of (\ref{SHORT.2-sum})$+$(\ref{SHORT.point-on-side})$\Rightarrow$(\ref{SHORT.angle}) in the proof of \ref{thm:defs_of_alex}.\qeds

\begin{thm}{Exercise} 
Let $\spc{L}\in\CBB{}{\kappa}$,
$p,x,y\in \spc{L}$
and $v,w\in \l]xy\r[$.
Prove that  
\[
\angk xyp=\angk xvp
\ \ \Leftrightarrow\ \ 
\angk xyp=\angk xwp.
\]

\end{thm}

\begin{thm}{Advanced Exercise} \label{ex:urysohn}
Construct a geodesic space $\spc{X}\notin\CBB{}0$, 
but which meets the following condition: for any 3 points $p,x,y\in \spc{X}$ there is a geodesic $[x y]$ such that for any $z\in \l]x y\r[$
\[\angk{0}{z}{p}{x}+\angk{0}{z}{p}{y}
\le
\pi.\]
\end{thm}

\begin{thm}{Advanced Exercise}\label{ex:lebedeva-petrunin}
Assume $\spc{L}$ be a complete length space such that for any quadrouple $p,x,y,z\in\spc{L}$ 
the following inequality holds
\[\dist[2]{p}{x}{}+\dist[2]{p}{y}{}+\dist[2]{p}{z}{}
\ge
\tfrac13\cdot
\l[
\dist[2]{x}{y}{}+\dist[2]{y}{z}{}+\dist[2]{z}{x}{}
\r].\eqlbl{eq:berg-nikolaev}\]
Prove that $\spc{L}\in\CBB{}{0}$.

Construct a metric on a 4-point set which satisfies inequality \ref{eq:berg-nikolaev} for any relabeling of its points by $p,x,y,z$, but which does not admit a distance preserving map into a $\CBB{}{0}$ space.
\end{thm}

Assume that for a trianglle $\trig{x^1}{x^2}{x^3}$ in a metric space its $\kappa$-model triangle
$\trig{\~x^1}{\~x^2}{\~x^3}=\modtrig\kappa({x^1}{x^2}{x^3})$ is defined.
We say the triangle $\trig{x^1}{x^2}{x^3}$ is \emph{$\kappa$-fat}\index{$\kappa$-fat} if the natural map (see definition \ref{def:k-thin}) 
$\trig{\~x^1}{\~x^2}{\~x^3}\to \trig{x^1}{x^2}{x^3}$ is distance non contracting.

\begin{thm}{Exercise}
Prove that any triangle with perimeter $<\varpi\kappa$ 
in a $\CBB{}{\kappa}$-space is $\kappa$-fat.
\end{thm}

The following exercise is inspired by Busemann's definition given in \cite{busemann-CBA}. 

\begin{thm}{Exercise}

\begin{subthm}{}
Show that any space $\spc{L}\in\CBB{}0$ satisfies the following condition:

\begin{itemize}
\item For any three points $p,q,r\in \spc{L}$, if $\bar q$ and $\bar r$ are midpoints of geodesics $[p q]$ and $[p r]$ correspondingly then $2\cdot\dist[{{}}]{\bar q}{\bar r}{}\ge\dist{q}{r}{}$.
\end{itemize}
\end{subthm}

\begin{subthm}{} Show that $\RR^2$ admits a metric defined by a norm
such that it satisfies above condition, but which is not an Alexandrov space.
\end{subthm}

\end{thm}

\section{Globalization}



The aim of this section is giving 
local analogs of $\CBB{}{\kappa}$ spaces 
and proving the equivalence to the global definitions 
--- so called globalization theorem.

First we need a local analog of the notion of a G-delta geodesic space (definition \ref{def:alm-geod}):

\begin{thm}{Definition}
Let $\spc{X}$ be a complete length space. 
An open set $\Omega\subset\spc{X}$ is called G-delta geodesic if for every point $p\in\Omega$ there is a G-delta set $W_p$ which is dense in $\Omega$ such that
for any $q\in W_p$ there is a geodesic $[p q]$ in $\spc{X}$.
\end{thm}

\begin{thm}{Theorem}\label{thm:=def-loc}
Let $\spc{X}$ be a complete length space and $p\in \spc{X}$.
Then the following conditions are equivalent:
\begin{subthmN}
{curv>=k}(local (1+3)-point comparison) there is $R_{\hbox{\rm\scriptsize\ref{SHORT.curv>=k}}}>0$ such that comparison 
\[\angk q{x^1}{x^2}
+\angk q{x^2}{x^3}
+\angk q{x^3}{x^1}
\le 2\cdot\pi\]
holds for any $q,x^1,x^2,x^3\in \oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.curv>=k}}})$.
\end{subthmN}

\begin{subthmN}{def:kirszbraun-loc}(local Kirszbraun property) 
there is $R_{\hbox{\rm\scriptsize\ref{SHORT.def:kirszbraun-loc}}}>0$, 
such that for any 3-point subset $F_3$ and any 4-point subset $F_4\supset F_3$ in $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.def:kirszbraun-loc}}})$, any short map $f\:F_3\to\Lob2\kappa$ can be extended as a short map $\bar f\:F_4\to\Lob2\kappa$ (so $f=\bar f|F_3$).
\end{subthmN}

\begin{subthmN}{conc-loc} (local function comparison) there is 
$R_{\hbox{\rm\scriptsize\ref{SHORT.conc-loc}}}>0$, such that 
$\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.conc-loc}}})$ 
is G-delta geodesic and for any 
$q\in \oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.conc-loc}}})$, 
the function $f=\md\kappa\circ\dist{q}{}{}$ satisfies 
$f''\le 1-\kappa\cdot  f$ in
$\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.conc-loc}}})$.
\end{subthmN}

\begin{subthmN}{2-sum-loc} (local adjacent angle comparison) there is
$R_{\hbox{\rm\scriptsize\ref{SHORT.2-sum-loc}}}>0$ 
such that $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.2-sum-loc}}})$ 
is G-delta geodesic and if $q$ and geodesic $[x y]$ lie in
$\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.2-sum-loc}}})$ and 
$z\in \l]x y\r[$ then
\[\angk z q x
+\angk z q y
\le \pi.\]
\end{subthmN}

\begin{subthmN}{monoton-loc} (local point-on-side comparison) 
there is $R_{\hbox{\rm\scriptsize\ref{SHORT.monoton-loc}}}>0$, 
such that $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.monoton-loc}}})$ is G-delta geodesic and if $q$ and geodesic $[x y]$ lie in $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.monoton-loc}}})$ 
and $z\in \l]x y\r[$, we have
\[\angk x q y
\le\angk x q z;\]
or, equivalently, 
\[\dist{\~p}{\~z}{}\le \dist{p}{z}{},\]
where $\trig{\~p}{\~x}{\~y}=\modtrig\kappa(p x y)$, $\~z\in\l] \~x\~y\r[$, $\dist{\~x}{\~z}{}=\dist{x}{z}{}$.
\end{subthmN}

\begin{subthmN}{angle-loc} (local hinge comparison) 
there is $R_{\hbox{\rm\scriptsize\ref{SHORT.angle-loc}}}>0$, such that $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.angle-loc}}})$ is G-delta geodesic and if $x\in \oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.angle-loc}}})$ then (1) for any hinge $\hinge x q y$, the angle 
$\mangle\hinge x q y$ is defined and (2) if $x\in \l]y z\r[$ then%
\footnote{Let us remind that $\hinge x q y$ and $\hinge x q z$  are short notations for pairs $([x q],[x y])$ and $([x q],[x z])$, 
thus these two hinges automatically have common side $[x q]$.}
\[\mangle\hinge x q y+ \mangle\hinge x q z\le\pi.\]
Moreover, if hinge $\hinge x q y$ lies in $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.angle-loc}}})$ then 
\[\mangle\hinge x q y
\ge\angk x q y.\]
or equivalently
\[\side\kappa \hinge x q y\ge\dist{q}{ y}{}.\]
\end{subthmN}


\begin{subthmN}{def:devel-alex-loc}(local development comparison) 
there is $R_{\hbox{\rm\scriptsize\ref{SHORT.def:devel-alex-loc}}}>0$, 
such that $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.def:devel-alex-loc}}})$ 
is G-delta geodesic and if a geodesic $\gamma$ lies in $\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.def:devel-alex-loc}}})$ and $q\in 
\oBall(p,R_{\hbox{\rm\scriptsize\ref{SHORT.def:devel-alex-loc}}})
\backslash \gamma$ then the $\kappa$-development $\~\gamma$ with respect to $q$ is convex.
\end{subthmN}
Moreover, for each pair $i,j\in \{1,2,\dots,7\}$ we can assume that $R_i>\tfrac{1}{9}\cdot R_j$.
\end{thm}

\parit{Proof.} The proof of each equivalence repeats the proof of corresponding global equivalence in localized form; see proofs of theorems \ref{thm:defs_of_alex}, \ref{thm:conc}, \ref{def:devel}, \ref{thm:kirsz-def}. \qeds

Now, let us give a local definition of lower curvature bound (\ref{df:cbb1+3}).

\begin{thm}{Definition}
Let $\spc{X}$ be a metric space and $p\in \spc{X}$, 
we say that \emph{$\spc{X}$ has curvature $\ge\Kappa$ at $p$} 
if $p$ satisfies any of the equivalent condition of Theorem~\ref{thm:=def-loc} for any $\kappa<\Kappa$.
\end{thm}



\begin{thm}{Globalization theorem}\label{thm:glob} 
Let $\spc{L}$ be a complete length metric space which is locally $\CBB{}{\kappa}$ then $\spc{L}$ is $\CBB{}{\kappa}$.
\end{thm}

In the two-dimensional case this theorem was proved in \cite{alexandrov:devel}, later, in \cite{toponogov-globalization+splitting} it was proved for Riemannian manifolds of all dimensions.
In the above generality, the theorem first appears in \cite{BGP}; simplifications and modifications were given in \cite{plaut:dimension}, \cite{shiohama}, \cite{BBI}.
Our proof, is based on presentations in  \cite{plaut:dimension} and \cite{BBI}.

The following corollary says that the expression ``space with curvature $\ge \kappa$'' makes sense.

\begin{thm}{Corollary}\label{cor:CAT>k-sence}
$\spc{L}\in\CBB{}{\Kappa}$ if and only if $\spc{L}\in\CBB{}{\kappa}$ for any $\kappa<\Kappa$.
\end{thm}

\parit{Proof.}
Note that if $\Kappa\le 0$, this statement follows directly from definition of Alexandrov space (\ref{df:cbb1+3}) and monotonicity of the function $\kappa\mapsto\angk x y z$ (\ref{k-decrease}).

The ``if''-part also follows directly from definition.

For $\Kappa>0$, the angle $\angk{\Kappa} x y z$ might be undefined, but, it is defined for sufficiently small triangles.
Thus, if $\kappa<\Kappa$ then
\[\spc{L}\in\CBB{}{\Kappa}\ \ \ \Longrightarrow\ \ \ ??? \spc{L}\ge\kappa\ \ \text{for any}\ \ p\in \spc{L}.\]
Applying  globalization theorem (\ref{thm:glob}), we get the ``only if''-part.
\qeds

For the proof of globalization theorem,
will need three lemmas.
First we need the following characterization of Alexandrov space; 
it coinsides with \ref{angle} if $\kappa\le 0$ and slightly weaker in case $\kappa>0$.


\begin{thm}{Short hinge lemma}\label{lem:devel-glob}
Let $\spc{L}$ be a complete G-delta geodesic space such that for any hinge $\hinge x p y$ in $\spc{L}$ the angle $\mangle\hinge x p y$ is defined 
and moreover, if $x\in \l]y z\r[$ then
\[\mangle\hinge x p y+\mangle\hinge x p z\le \pi.\] 

Assume that  for any hinge $\hinge x p y$ in $\spc{L}$ we have
\[\dist{p}{ x}{}+\dist{x}{ y}{}<\varpi\kappa\ \ \Rightarrow\ \ 
\mangle\hinge x p y
\ge\angk x p y,\]
then $\spc{L}\in\CBB{}{\kappa}$.
\end{thm}

%???THE PROOF IS ALMOST IDENTICAL TO {thm:devel}, MAYBE IT IS BETTER TO MAKE IT ONCE???

\parit{Proof.} 
If $\kappa\le0$, the lemma follows directly from the hinge comparison (\ref{angle}).
For $\kappa>0$ the proof is very similar to the proof of equivalence of development comparison definition (\ref{thm:devel}).

Applying rescaling, we can assume that $\kappa=1$, 
therefore $\Lob{2}\kappa=\SS^2$ and $\varpi\kappa=\pi$.

According to \ref{thm:devel}, it is enough to show that  for any point $p\in \spc{L}$ and any geodesic $\gamma\:[0,T]\to \oBall(p,\pi)\backslash \{p\}$, its $\kappa$-development with respect to $p$ is convex.

\begin{wrapfigure}{r}{31mm}
\begin{lpic}[t(-4mm),b(-0mm),r(0mm),l(0mm)]{pics/development(0.4)}
\lbl[r]{21,3;$\~p'$}
\lbl[l]{70,23;$\~x_0$}
\lbl[l]{68,43;$\~x_1$}
{\Large\lbl[lb]{57,58;$.$}
\lbl[lb]{39,69;$.$}
\lbl[b]{20,72;$.$}}
\lbl[b]{2,65;$\~x_n$}
\end{lpic}
\end{wrapfigure}

Clearly $\dist{p}{\gamma(t)}{}<\pi-\eps$ for some fixed $\eps>0$.
Consider partition $0=t_0<t_1<\dots<t_n=T$ such that $|t_i-t_{i-1}|<\eps$.
Set $x_i=\gamma(t_i)$ 
and choose a point $p'\in \Str(x_0,x_1,\dots,x_n)$ sufficiently close to $p$.
Construct a chain of model triangles 
$\trig{\~p'}{\~x_{i-1}}{\~x_i}=\modtrig\kappa(p' x_{i-1}x_i)$ on such a way that direction $[\~p'\~x_i]$ turns conterclockwise as $i$ grows.
From the assumption of the lemma, 
\[\begin{aligned}
\mangle\hinge {\~x_i}{\~x_{i-1}}{\~p'}
+\mangle\hinge{\~x_i}{\~x_{i+1}}{\~p'}
&=
\angk{x_i}{x_{i-1}}{p'}
+\angk{x_i}{x_{i+1}}{p'}
\le
\\
&\le
\mangle\hinge{x_i}{x_{i-1}}{p'}
+\mangle\hinge{x_i}{x_{i+1}}{p'}
\le
\\
&\le
\pi.
\end{aligned}\eqlbl{eq:angles=<pi}
\]

Note that
\[\sum_{i=1}^n\mangle\hinge{\~p'}{\~x_i}{\~x_{i-1}}\le\pi\eqlbl{clm:T>2sides}\]
Indeed, if $\sum_{i=1}^n\mangle\hinge{\~p'}{\~x_i}{\~x_{i-1}}>\pi$,
then for some $\kay$ there is a point $\~y\in[\~x_{\kay}\~x_{\kay+1}]$ such that
\[\mangle\hinge{\~p'}{\~x_0}{\~x_{1}}
+
\dots
+
\mangle\hinge{\~p'}{\~x_{\kay-1}}{\~x_\kay}
+
\mangle\hinge{\~p'}{\~x_{\kay}}{\~y}
=\pi.\]
By \ref{eq:angles=<pi}, 
the broken line $\~x_0\~x_1\dots\~x_\kay\~y$
is convex; in particular,
\[
\dist{\~p'}{\~x_0}{\SS^2}+\dist{\~p'}{\~y}{\SS^2}\le\pi\]
Therefore, by triangle inequality
\[\dist{\~x_0}{\~x_{1}}{\SS^2}+\dots+\dist{\~x_{\kay-1}}{\~x_\kay}{\SS^2}+\dist{\~x_\kay}{\~y}{\SS^2}\ge \dist{\~p'}{\~x_0}{\SS^2}+\dist{\~p'}{\~y}{\SS^2}\]
Applying the triangle inequality again, 
we get
\[\dist{\~y}{\~x_{\kay+1}}{\SS^2}+\dist{\~x_{\kay+1}}{\~x_{\kay+2}}{\SS^2}+\dots+\dist{\~x_{n-1}}{\~x_n}{\SS^2}> \dist{\~p'}{\~x_n}{\SS^2}-\dist{\~p'}{\~y}{\SS^2}\]

Hence
\[T=\sum_{i=1}^n\dist{\~x_i}{\~x_{i-1}}{\SS^2}>\dist{\~p'}{\~x_{0}}{\SS^2}+\dist{\~p'}{\~x_n}{\SS^2}.\]
The later contradicts that $\gamma$ is length minimizing.

From \ref{eq:angles=<pi} and \ref{clm:T>2sides}, it follows that the spherical polygon $[\~p'\~x_0\~x_1\dots \~x_n]$ is convex.

Taking finer and finer partitions and passing to the limit $p'\to p$, the broken line $\~x_0\~x_1\dots \~x_n$ approaches development of $\gamma$ with respect to $p$ and the statement follows.
\qeds

The following lemma says that if comparison holds for all small hinges then it holds for slightly bigger hinges near the given point.

\begin{thm}{Key lemma}\label{key-lem:globalization} 
Let $\kappa\in \RR$, 
$0<\ell\le\varpi\kappa$, 
$\spc{X}$ be a complete geodesic space 
and $p\in \spc{X}$ be a point 
such that $???_x \spc{X}\ge\kappa$ for any $x\in \oBall(p,2\cdot\ell)$. 

Assume that for any point 
$q\in \oBall(p,{\ell})$, comparison
\[\mangle\hinge x y q
\ge\angk x y q\]
holds for any hinge $\hinge x y q$ with 
$\dist{x}{y}{}+\dist{x}{q}{}
<
\frac{2}{3}\cdot\ell$.
Then comparison
\[\mangle\hinge x p q
\ge\angk x p q\] 
holds for any hinge $\hinge x p q$ with $\dist{x}{ p}{}+\dist{x}{q}{}<\ell$.
\end{thm}

\begin{wrapfigure}{r}{36mm}
\begin{lpic}[t(0mm),b(5mm),r(0mm),l(3mm)]{pics/globalization(0.3)}
\lbl[l t]{64,4;$\~ p$}
\lbl[l]{65,165;$\~ q$}
\lbl[r]{1,65;$\~ x$}
\lbl[r b]{38,121;$\~ x'$}
\lbl[l]{45,116;$\ge \mangle\hinge{x'}p q$}
\lbl[lw]{15,63;$\le \mangle\hinge x p q$}
\end{lpic}
\end{wrapfigure}

\parit{Proof of key lemma (\ref{key-lem:globalization}) .} 
We will prove an equivalent inequality:
\[\side\kappa \hinge x p q
\ge\dist{p}{q}{}.\eqlbl{eq:thm:=def-loc*}\] 
for any hinge $\hinge x p q$ with $\dist{x}{p}{}+\dist{x}{q}{}<\ell$.

Fix $q$.
Given a hinge $\hinge x p q$ such that 
$\tfrac{2}{3}\cdot\ell \le\dist{p}{x}{}\z+\dist{x}{q}{}< \ell$, let us construct a new hinge $\hinge{x'}p q$ which is smaller, i.e.
\[
\dist{p}{x}{}+\dist{x}{q}{}\ge\dist{p}{x'}{}+\dist{x'}{q}{}
\eqlbl{eq:thm:=def-loc-fourstar}\]
and such that 
\[\side\kappa \hinge x p q
\ge\side\kappa \hinge{x'}p q.
\eqlbl{eq:thm:=def-loc-fivestar}\]

%\parit{Construction of $\hinge{x'}p q$.}
Assume $\dist{x}{q}{}\ge\dist{x}{p}{}$, otherwise switch the roles of $p$ and $q$ in the following construction.
Take $x'\in [x q]$ such that 
\[\dist{p}{x}{}+3\cdot\dist[{{}}]{x}{x'}{}
=\tfrac{2}{3}\cdot\ell \eqlbl{3|xx'|}\]
Choose a geodesic $[x' p]$ and consider the  hinge $\hinge{x'}p q$ fromed by $[x'p]$ and $[x' q]\subset [x q]$. 
(In fact the same argument as in \ref{thm:g-split} shows that 
condition $[x' q]\subset [x q]$ always holds.)

Then \ref{eq:thm:=def-loc-fourstar} follows from the triangle inequality.

Further, note that we have $x,x'\in \oBall(p,\ell)\cap \oBall(q,\ell)$ and moreover
$\dist{p}{x}{}\z+\dist{x}{x'}{},\dist{p}{x'}{}\z+\dist{x'}{x}{}<\tfrac{2}{3}\cdot\ell $.
In particular, 

\[\mangle\hinge x p{x'}
\ge\angk x p{x'}
\ \ \text{and}\ \ 
\mangle\hinge {x'}p x
\ge\angk {x'}p x.
\eqlbl{eq:thm:=def-loc-threestar}\]


Now, let 
$\trig{\~x}{\~x'}{\~p}=\modtrig\kappa(x x' p)$.
Take $\~ q$ on the extension of $[\~ x\~ x']$ beyond $x'$ such that $\dist{\~x}{\~q}{}=\dist{x}{q}{}$ (and therefore $\dist{\~x'}{\~q}{}=\dist{x'}{q}{}$).
From \ref{eq:thm:=def-loc-threestar},
\[\mangle\hinge x p q
=\mangle\hinge  x p{x'}\ge\angk x p{x'}\ \ \Rightarrow\ \ 
\side\kappa \hinge x q p\ge\dist{\~p}{\~q}{}.\]
From the assumptions of the lemma, we have $\mangle\hinge{x'}p x+\mangle\hinge{x'}p q\le \pi$; 
thus \ref{eq:thm:=def-loc-threestar} implies
\[
\pi
-\angk{x'}p x
\ge
\pi-\mangle\hinge{x'}p x
\ge
\mangle\hinge{x'}p q.
\]
Therefore
$\dist{\~p}{\~q}{}\ge\side\kappa \hinge{x'}q p$ and \ref{eq:thm:=def-loc-fivestar} follows.

\medskip

\begin{center}
\begin{lpic}[t(0mm),b(0mm),r(0mm),l(3mm)]{pics/px_nq(0.6)}
\lbl[r]{1,30;$x_0$}
\lbl[rt]{30,0;$p$}
\lbl[tl]{143,0;$q$}
\lbl[l b]{49,20;$x_1$}
\lbl[l b]{102,10;$x_2$}
\lbl[b]{68,6;$x_3$}
\lbl[tw]{103,2;$x_4$}
\lbl[t]{70,1;$x_5$}
\end{lpic}
\end{center}

%%%??? WE SHOULD MENTION cat's cradle.
Let us continue the proof.
Set $x_0=x$.
Let us apply inductively the above construction to get a sequence of hinges  $\hinge{x_n}p q$ with $x_{n+1}=x_n'$.

The sequence might terminate at some $n$ only if $\dist{p}{x_n}{}+\dist{x_n}{q}{}\z< \tfrac{2}{3}\cdot\ell $.
In this case, by the assumptions of the lemma, $\side\kappa \hinge{x_n}p q\ge\dist{p}{q}{}$.
From \ref{eq:thm:=def-loc-fivestar}, we get that the sequence  $s_n\z=\side\kappa \hinge{x_n}p q$ is decreasing.
Hence inequality \ref{eq:thm:=def-loc*} follows.

Otherwise, the sequence $r_n=\dist{p}{x_n}{}+\dist{x_n}{q}{}$ is non-increasing and $r_n\ge\tfrac{2}{3}\cdot\ell$ for all $n$. Hence $r_n\to r$ as $n\to\infty$.
Pass to a subsequence $y_\kay=x_{n_\kay}$ such that $y_\kay'=x_{n_\kay+1}\in [y_\kay q]$.
(In particular, $\dist{y_\kay}{q}{}\ge\dist{y_\kay}{p}{}$.)
Clearly, \[\dist{p}{y_\kay}{}+\dist{y_\kay}{y_\kay'}{}\z-\dist{p}{y_\kay'}{}=r_\kay-r_{\kay+1}\underset{\kay\to\infty} {\to}0.
\eqlbl{trig=}\]
From \ref{3|xx'|}, 
it follows that  $\dist{y_\kay}{y'_\kay}{}\z>\tfrac{\ell}{100}$.
From \ref{3|xx'|} and \ref{trig=}, it follows that 
$\dist{p}{y_\kay}{}\z>\tfrac{\ell}{100}$
for all large $\kay$.
Therefore, $\angk{y_\kay}p{y_\kay'}\to \pi$. 
Since 
$\mangle\hinge{y_\kay}p{y_\kay'}
\ge\angk{y_\kay}p{y_\kay'}$, we have 
$\mangle\hinge{y_\kay}p q=\mangle\hinge{y_\kay}p{y_\kay'}\to \pi$.
Therefore, 
\[\dist{p}{y_\kay}{}+\dist{y_\kay}{q}{}-\side\kappa \hinge{y_\kay}p q\to 0.\] 
(Here we used that $\ell\le\varpi\kappa$.) 
Together with the triangle inequality
\[
\dist{p}{y_\kay}{}+\dist{y_\kay}{q}{}\ge\dist{p}{q}{}
\]
this yields
\[\lim_{n\to\infty}\side\kappa \hinge{y_\kay}p q\ge \dist{p}{q}{}.\]
Applying monotonicity of sequence  $s_n=\side\kappa \hinge{y_\kay}p q$ we obtain \ref{eq:thm:=def-loc*}.
\qeds

The following lemma is analogous to the existence of minimum point on a compact.


\begin{thm}{Lemma on almost minimum}\label{lem:alm-min}
Let $\spc{X}$ be a complete metric space,
$p\in \spc{X}$
and $r\:\spc{X}\to \RR$ be a function.
Assume that for some $\eps>0$,
the function $r$ is strictly positive in $\cBall[p,\tfrac{1}{\eps^2}\cdot r(p)]$ and
$\varliminf_{n}r(x_n)>0$ for any convergent sequence 
$x_n\to x\in \cBall[p,\tfrac{1}{\eps^2}\cdot r(p)]$. 

Then, there is a point $p^*\in \cBall[p,\tfrac{1}{\eps^2}\cdot r(p)]$ such that 

\begin{subthm}{}$r(p^*)\le r(p)$ and
\end{subthm}

\begin{subthm}{}$r(x)> (1-\eps)\cdot r(p^*)$ 
for any $x\in \cBall[p^*,\tfrac{1}{\eps}\cdot r(p^*)]$.
\end{subthm}
\end{thm}

\parit{Proof.} 
Assume the statement is wrong. 
Then for any $x\in \oBall(p,\tfrac{1}{\eps^2}\cdot r(p))$ with $r(x)\le r(p)$, there is a point $x'\in \spc{X}$ such that 
\[\dist{x}{x'}{}<\tfrac{1}\eps\cdot r(x)
\ \ \text{and}\ \ 
r(x')\le (1-\eps)\cdot r(x).\]
Take $x_0=p$ and consider a sequence of points $(x_n)$ such that $x_{n+1}=x_n'$.
Clearly 
\[\dist{x_{n+1}}{x_n}{}
\le
\tfrac{r(p)}{\eps}\cdot(1-\eps)^n
\ \ \hbox{and}\ \ 
r(x_n)\le r(p)\cdot(1-\eps)^n.\] 
In particular, $\dist{p}{x_n}{}<\tfrac{1}{\eps^2}\cdot r(p)$.
Therefore $(x_n)$ is a Cauchy sequence,
$x_n\to x\in \cBall[p,\tfrac{1}{\eps^2}\cdot r(p)]$
and
$\lim_{n}r(x_n)=0$, a contradiction.
\qeds




\parit{Proof of the globalization theorem (\ref{thm:glob}).} 
Note that since for fixed points $x,y,z\in \spc{L}$, 
the function $\kappa\mapsto\angk x y z$ is continuous, 
it is enough to show that $\spc{L}\in\CBB{}{\kappa}$ 
for any $\kappa<\Kappa$.
For the rest of the proof we fix some $\kappa<\Kappa$.

Exactly the same argument as in the proof of Theorem~\ref{thm:almost.geod} 
shows that $\spc{L}$ is G-delta geodesic.
By Theorem~\ref{angle-loc}, 
for any hinge $\hinge x p y$ in $\spc{L}$ the angle $\mangle\hinge x p y$ is defined 
and moreover, if $x\in \l]y z\r[$ then
\[\mangle\hinge x p y+\mangle\hinge x p z\le \pi.\] 

Let us denote by $\ComRad(p,\spc{L})$ 
(which stands for \emph{comparison radius} of $\spc{L}$ at $p$) 
the maximal value (possibly $\infty$) such that the comparison 
\[\mangle\hinge x p y
\ge\angk x p y\]
holds for any hinge $\hinge x p y$ with $\dist{p}{x}{}+\dist{x}{y}{}< \ComRad(p,\spc{L})$.

As follows from \ref{conc-loc}, $\ComRad(p,\spc{L})>0$ for any $p\in\spc{L}$ and 
$$\liminf_{n\to\infty}\ComRad(p_n,\spc{L})>0$$ 
for any converging sequence of points $p_n\to p$.
That makes it possible to apply the lemma on almost minimum (\ref{lem:alm-min}) to the function $p\mapsto \ComRad(p,\spc{L})$.

According to Short hinge lemma (\ref{lem:devel-glob}), it is enough to show that 
\[s_0=\inf_{p\in\spc{L}}\ComRad(p,\spc{L})
\ge \varpi\kappa\ \ 
\text{for any}\ \ 
p\in \spc{L}.
\eqlbl{eq:thm:=def-loc-star-star}\]
We argue by contradiction, assuming that  \ref{eq:thm:=def-loc-star-star} does not hold.

The rest of the proof is easier for geodesic spaces 
and yet easier for compact spaces.
Thus we give three different arguments  for each of these cases.

\parit{End of the proof for a compact space.}
By Theorem~\ref{conc-loc} 
and compactness of $\spc{L}$, 
it's immediate that $s_0>0$.
Take a point $p^*\in \spc{L}$ such that $r^*=\ComRad(p^*,\spc{L})$ is sufficiently close to $s_0$
($p^*$ such that  $s_0\le r^*<\min\{\varpi\kappa,\tfrac32\cdot s_0\}$ will do).
Then the key lemma (\ref{key-lem:globalization}) applied for $p^*$ and $\ell$ slightly bigger than $r^*$ (say, such that $r^*<\ell<\min\{\varpi\kappa,\tfrac32\cdot s_0\}$) implies that
\[\mangle\hinge x{p^*}q
\ge\angk x{p^*}q\]
for any hinge $\hinge x{p^*}q$ such that $\dist{p^*}{x}{}+\dist{x}{q}{}<\ell$.
Thus $r^*\ge\ell$, a contradiction.

\parit{End of the proof for a geodesic space.}
Fix $\eps=0.0001$. 
Apply the lemma on almost minimum (\ref{lem:alm-min}) to find a point $p^*\in \spc{L}$ such that $r^*\z=\ComRad(p^*,\spc{L})<\varpi\kappa$ and 
\[\ComRad(q,\spc{L})\z> (1-\eps)\cdot r^*\eqlbl{comrad(q)}\] 
for any $q\in\cBall[p^*,\tfrac{1}{\eps}\cdot r^*]$. 

Applying the key lemma (\ref{key-lem:globalization}) for $p^*$ and $\ell$ slightly bigger than $r^*$ leads to a contradiction.

\parit{End of the proof, general case.}
Let us construct $p^*\in\spc{L}$ as in the previous case.
Since $\spc{L}$ is not geodesic, we can not apply the key lemma directly.
Instead, let us pass to the ultrapower $\spc{L}^\o$ which
 is a geodesic space (see \ref{cor:ulara-geod}).

According to Theorem~\ref{thm:=def-loc},
inequality \ref{comrad(q)} implies that
Condition~\ref{curv>=k} holds for some fixed $R_{\hbox{\rm\scriptsize\ref{SHORT.curv>=k}}}=\tfrac{r^*}{100}
>0$ at any point $q\in\cBall[p^*,\tfrac1{2\cdot \eps}\cdot r^*]\subset\spc{L}$.
Therefore a similar statement is true in the ultrapower $\spc{L}^\o$;
i.e.
for any point
$q_\o\in\cBall[p^*,\tfrac1{2\cdot \eps}\cdot r^*]\subset\spc{L}^\o$, 
 Condition~\ref{curv>=k} holds for say $R_{\hbox{\rm\scriptsize\ref{SHORT.curv>=k}}}=\tfrac{r^*}{101}$.
In particular, $???_{q_\o}\spc{L}^\o\ge\kappa$ 
for any $q_\o\in\cBall[p^*,\tfrac1{2\cdot \eps}\cdot r^*]\subset\spc{L}^\o$.

Note that $r^*\ge\ComRad(p^*,\spc{L}^\o)$.
Therefore we can apply the lemma on almost minimum 
at point $p^*$ for space $\spc{L}^\o$
with function $x\mapsto\ComRad(x,\spc{L}^\o)$
and $\eps'=\sqrt\eps=0.01$.

For the obtained point $p^{{*}{*}}\in \spc{L}^\o$, we have $r^{{*}{*}}\z=\ComRad(p^{{*}{*}},\spc{L})<\varpi\kappa$ 
and 
$\ComRad(q_\o,\spc{L}^\o)\z> (1-\eps')\cdot r^{{*}{*}}$ for any $q_\o\in\cBall[p^{{*}{*}},\tfrac{1}{\eps'}\cdot r^{{*}{*}}]$. 
Thus applying the key lemma (\ref{key-lem:globalization}) for $p^{{*}{*}}$ and $\ell$ slightly bigger than $r^{{*}{*}}$ leads to a contradiction.
\qeds

\begin{thm}{Advanced Exercise}
Assume $\spc{X}$ is a non-complete geodesic space for which the (1+3)-point $\kappa$-comparison holds in a neighborhood of every point. 
Prove that completion of $\spc{X}$ is an Alexandrov's space with curvature $\ge\kappa$.
\end{thm}
