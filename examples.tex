%%!TEX root = invitation.tex
\chapter{Subsets}

In this chapter we give a partial answer to the following question.
{}\emph{Which subsets of Euclidean space, equipped with their induced length-metrics, form  $\Cat{}{0}$ spaces?}

\section{Motivating examples}

Consider three subgraphs of different quadric surfaces:
\begin{align*}
A&=\set{(x,y,z)\in\EE^3}{z\le x^2+y^2},
\\
B&=\set{(x,y,z)\in\EE^3}{z\le -x^2-y^2},
\\
C&=\set{(x,y,z)\in\EE^3}{z\le x^2-y^2}.
\end{align*}

\begin{thm}{Question}
Which of the sets $A$, $B$ and $C$, if equipped with the induced length metric, forms a $\Cat{}{0}$ space and why?
\end{thm}

The answer is given below, but it is instructive to think about this question before reading further.

\parbf{$\bm{A}$.} No, $A$ is not $\Cat{}{0}$.
 
The boundary $\partial A$ is the paraboloid described by  $z=x^2+y^2$;  in particular it bounds an open convex set in $\EE^3$ whose complement is $A$.
The closest point projection of $A\to\partial A$ is short (Exercise~\ref{ex:closest-point}).
It follows that $\partial A$ is a convex set in $A$ equipped with its induced length metric.

Therefore if $A$ is $\Cat{}{0}$ then so is $\partial A$.
The latter is not true: $\partial A$ is a smooth convex surface, and has strictly positive curvature by the Gauss formula.


\parbf{$\bm{B}$.} Yes, $B$ is $\Cat{}{0}$. 

Evidently $B$ is a convex closed set in $\EE^3$. 
Therefore the length metric on $B$ coincides with Euclidean metric
and $\Cat{}{0}$ comparison holds.

\parbf{$\bm{C}$.} Yes, $C$ is $\Cat{}{0}$, 
but the proof is not as easy as before.
We give a sketch here;
a complete proof of a more general statement is given in Section \ref{sec:smooth-bry}.

Consider the one-parameter family of sets 
\[V_t=\set{(x,y,z)\in\EE^3}{z\le x^2-y^2 -2\cdot (x-t)^2}.\]


\begin{wrapfigure}{r}{41mm}
\begin{lpic}[t(-5mm),b(-1mm),r(0mm),l(0mm)]{pics/K_s-0(1)}
\lbl{10,23;{\color{white}$V_{a}$}}
\lbl{20,23;{\color{white}$V_b$}}
\lbl{30,23;{\color{white}$V_c$}}
\end{lpic}
\end{wrapfigure}

Each set $V_t$ is the subgraph of a paraboloid tangent to $\partial C$ along the curve $(t,y,t^2-y^2)$. Thus $V_t$ is closed and convex, and
\[C=\bigcup_t V_t.\]
Further note that 
\begin{clm}{}\label{eq:VcVnV-0}
If $a<b<c$ then $V_b\supset V_a\cap V_c$.
\end{clm}

The inclusion \ref{eq:VcVnV-0} makes it possible to apply Reshetnyak gluing theorem \ref{thm:gluing} recursively, in order to show that any finite union of $V_t$ forms a $\Cat{}{0}$ space.
By approximation, the $\Cat{}{0}$ comparison holds for any 4 points in $C$;
that is, $C$ is $\Cat{}{0}$.

\parbf{Remark.}
The set $C$ is not convex, but it is two-convex as defined in the next section.
As you will see, two-convexity of subsets is closely related to the inheritance of an upper curvature bound by a subset.

\section{Two-convexity}

The following definition is closely related to the one given by Mikhael Gromov in \cite[\S\textonehalf]{gromov:SaGMC}, see also \cite{panov-petrunin:sweeping}.

\begin{thm}{Definition}\label{def:two-convex}
We say that a subset $K\subset \EE^m$ is \index{two-convex set}\emph{two-convex}
if the following condition holds for any plane $W\subset\EE^m$:
If $\gamma$ is a simple closed curve in $W\cap K$ 
which is null-homotopic in $K$,  
then it is null-homotopic in $W\cap K$, in particular the disc in $W$ bounded by $\gamma$ lies in $K$.
\end{thm}

Note that two-convex sets do not have to be connected nor simply connected. 
The following two propositions follow immediately from the definition.

\begin{thm}{Proposition}
Any subset in $\EE^2$ is two-convex.
\end{thm}


\begin{thm}{Proposition}\label{prop:two-hull}
The intersection of an arbitrary collection of two-convex sets in $\EE^m$ is two-convex.
\end{thm}

\begin{thm}{Proposition}\label{prop:two-hull-open}
The interior of any two-convex set in $\EE^m$ is a two-convex set.
\end{thm}

\parit{Proof.}
Let $K\subset \EE^m$ be two-convex and let $W$ be a 2-plane.
Fix a closed simple plane curve $\gamma$ in $W\cap \Int K$ 
which is contractible in the interior of $K$.

Since $K$ is two-convex,
the plane disc $D$ bounded by $\gamma$ lies in $K$.
The same holds for the translations of $D$ by small vectors.
Therefore $D$ lies in the interior of $K$.
Hence the statement follows.
\qeds

\begin{thm}{Definition}
Given a subset $K\subset \EE^m$, define its two-convex hull (briefly, $\Conv_2K$) as the intersection of all two-convex subsets containing $K$.
\end{thm}

Note that by Proposition~\ref{prop:two-hull},
the two-convex hull of any set is two-convex.
Further, 
by Proposition~\ref{prop:two-hull-open}, the
two-convex hull of an open set is open.

The next proposition describes  closed two-convex sets with smooth boundary.

\begin{thm}{Proposition}\label{prop:two-cove+smooth}
Let $K\subset \EE^m$ be a closed subset.

Assume that the boundary of $K$ forms a smooth hypersurface $S$.
Consider the unit normal vector field $\nu$ on $S$ that  points outside of $K$.
Denote by $k_1\le \dots\le k_{m-1}$ the scalar fields of principal curvatures on $S$ with respect to $\nu$ (for example, if $K$ is convex then  $k_1\ge 0$).

Then $K$ is two-convex if and only if $k_2(p)\ge 0$ for any point $p\in S$.
Moreover, if $k_2(p)<0$ at some point $p$, then Definition~\ref{def:two-convex} fails for some curve $\gamma$ forming a triangle in an arbitrary neighborhood of $p$.
\end{thm}

The proof is taken from \cite[\S\textonehalf]{gromov:SaGMC}, but we added  some details.
%???added

%???this ``if'' and ``only-if'' parts --- I am not sure what is the best way to call it. Maybe Stephanie can decide and make it uniform???
\parit{Proof; ``only-if'' part.}
If $k_2(p)<0$ for some $p\in S$,
consider the plane $W$ through $p$  spanned by the first two principal directions.
Choose a small triangle in $W$ which surrounds $p$ and move it slightly in the direction of $\nu(p)$.
We get a triangle $[xyz]$ which is null-homotopic in $K$,
but the solid triangle $\Delta=\Conv\{x,y,x\}$ bounded by $[xyz]$ does not lie in $K$ completely.
Therefore $K$ is not two-convex.

\parit{``If'' part.}
Recall that a smooth function $f\:\EE^m\to\RR$ is called \emph{strongly convex} if its Hessian is
 positive definite at each point.


Suppose $f\:\EE^m\to\RR$ is a smooth strongly
convex function 
such that the restriction $f|_S$ is a Morse function.
Note that a generic smooth strongly convex function $f\:\EE^m\to\RR$ has this property.

For a critical point $p$ of $f|_S$, the outer normal vector $\nu(p)$ is parallel to the gradient $\nabla_pf$;
we say that $p$ is a 
\index{positive critical point}\emph{positive critical point}
if $\nu(p)$ and $\nabla_p f$ point in the same direction, 
and 
\index{negative critical point}\emph{negative} otherwise.
If $f$ is generic, then we can assume that the sign is defined for all critical points;
that is, $\nabla_pf\ne0$ for any critical point $p$ of $f|_S$.

Since $k_2\ge 0$ and $f$ is strongly convex, 
the negative critical points of $f|_S$
have index at most $1$.

Given a real value $s$, set 
\[K_s=\set{x\in K}{f(x)<s}.\]
Assume  $\phi_0\:\DD\to K$ is a continuous map of the disc $\DD$
such that $\phi_0(\partial \DD)\subset K_s$.
By the Morse Lemma, 
there is a homotopy $\phi_t\:\DD\to K$ rel $\partial \DD$ such that 
$\phi_1(\DD)\subset K_s$.

Indeed, we can construct a homotopy $\phi_t\:\DD\to K$ which decreases the maximum of $f\circ\phi$ on $\DD$ until in hangs on a critical point $p$ of $f|_S$.
This point can not be negative, otherwise its index would be at least 2.
If this critical point is positive then it is easy to decrease the maximum a little by pushing the disc from $S$ into $K$ in the direction of $-\nabla f_p$.

Consider a closed curve $\gamma\:\SS^1\to K$ which is null-homotopic in $K$.
Note that the distance function \[f_0(x)\z=\dist{\Conv\gamma}{x}{\EE^m}\] 
is convex.
Therefore $f_0$ can be approximated by smooth strongly convex functions $f$ in general position.
From above, there is a disc in $K$ with boundary $\gamma$
which lies arbitrary close to $\Conv\gamma$.
Since $K$ is closed, the statement follows.
\qeds

Note that the ``if'' part proves a somewhat stronger statement.
Namely,  any plane curve $\gamma$ (\emph{not necessary simple}) which is  contractible in $K$ is also contractible in the intersection of $K$ with the plane of $\gamma$.
The latter condition does not hold for the complement 
of two planes in $\EE^4$ which is two-convex by Proposition~\ref{prop:two-hull};
see also Exercise~\ref{ex:two-planes} below.
The following proposition shows that there are no such open examples in $\EE^3$.

\begin{thm}{Proposition}\label{prop:3d-strong-2-convexity}
Let $\Omega\subset\EE^3$ be an open two-convex subset.
Then for any plane $W\subset\EE^3$
any closed curve in $W\cap \Omega$ 
which is null-homotopic in $\Omega$ is also null-homotopic in $\Omega\cap W$.
\end{thm}

In the proof we use Papakyriakopoulos' Loop theorem.
It states that for any 3-dimensional manifold $M$ with nonempty boundary $\partial M$, if 
$f\: (D^2,\partial D^2)\to (M,\partial M)$
is a continuous map from disc $D$ such that $f|\partial D^2$ not null-homotopic in $\partial M$, then there is an embedding 
$h\: (D^2,\partial D^2)\to (M,\partial M)$ 
with the same property.
A proof can be found in \cite{hatcher}.

\parit{Proof.}
Fix a closed plane curve $\gamma$ in $W\cap \Omega$ which is null-homotopic in $\Omega$. Suppose $\gamma$ is not contractible in  $W\cap \Omega$.

Let $\phi\co D\to\Omega$ be a disk that bounds $\gamma$.

Since $\Omega$ is open we can first change  $\phi$  slightly so that $\phi(x)\notin W$ for $1-\eps<|x|<1$ for some small $\eps>0$.
By further changing $\phi$ slightly we can assume that it is transversal to $W$ and agrees with the previous map near $\partial D$.


This means that $\phi^{-1} (W)\cap \Int D$ consists of finitely many simple closed curves which cut $D$ into several components. 
Consider one of the ``innermost'' components. 
It is a disk $D'$ with boundary $c'$. 
Then  $\phi(c')$ is a closed curve in $W$. 

Note that by construction  $\phi(D')$  completely lies in one of the two half-spaces  with boundary $W$. 
Let's denote that half-space by $H$.
If $\phi(c')$ is not contractible in $W\cap \Omega$ then applying the Loop Theorem to $M^3=H\cap \Omega$ we conclude that  there exists a \emph{simple} closed curve $\gamma'\subset \Omega\cap W$ which is not contractible in $\Omega\cap W$ but is contractible in $\Omega\cap H$. 
This contradicts two-convexity of $\Omega$. 

Hence $\phi(c')$ is contractible in $W\cap \Omega$. Therefore $\phi$ can be changed in a small neighborhood $U$ of $D'$ so that the new map $\hat\phi$ maps $U$ to one side of $W$. 
In particular, the set $\hat\phi^{-1}(W)$ consists of the same curves as $\phi^{-1} (W)$ with the exception of $c'$.

Repeating this process several times we reduce the problem to the case where $\phi^{-1} (W)\cap \Int D=\emptyset$. This means that $\phi(D)$ lies entirely in one of the half-spaces bounded by $W$.

Again applying the Loop Theorem we obtain a simple closed curve in $W\cap \Omega$ which is not contractible in $W\cap \Omega$ but is contractible in $\Omega$. 
This again contradicts two-convexity of $\Omega$. 
Hence $\gamma$ is contractible in  $W\cap \Omega$ as claimed.
\qeds




\section{Sets with smooth boundary}\label{sec:smooth-bry}

In this section we characterize the subsets with smooth boundary in $\EE^m$  that form $\Cat{}{0}$ spaces. 


\begin{thm}{Theorem}\label{thm:set-with-smooth-bry:CBA}
Let $K$ be a closed, simply connected subset in $\EE^m$ equipped with the induced length metric.
Assume $K$ is bounded by a smooth hypersurface.
Then 
$K$ is $\Cat{}{0}$ if and only if $K$ is two-convex.
\end{thm}


This theorem is a baby case of the main result in \cite{a-b-b:CBA-m-w-b}, which is briefly discussed at the end of the chapter. 


\parit{Proof.}
Denote by $S$  and by $\Omega$ the boundary and the interior of $K$ respectively. 
Since $K$ is connected and $S$ is smooth, $\Omega$ is also connected.

Denote by $k_1(p)\le\dots\le k_{m-1}(p)$ the principle curvatures of $S$ at $p\in S$ with respect to the normal vector $\nu(p)$ pointing out of $K$.
By Proposition~\ref{prop:two-cove+smooth}, $K$ is two-convex if and only if $k_2(p)\ge 0$ for any $p\in S$.

\begin{wrapfigure}{r}{35mm}
\begin{lpic}[t(-4mm),b(-3mm),r(0mm),l(0mm)]{pics/not-two-convex(1)}
\end{lpic}
\end{wrapfigure}

\parit{``Only-if'' part.}
Assume $K$ is not two-convex.
Then by Proposition~\ref{prop:two-cove+smooth}, there is a triangle $[xyz]$ in $K$ which is null-homotopic in $K$,
but the solid triangle $\Delta=\Conv\{x,y,z\}$ does not lie in $K$ completely.
Evidently the triangle $[xyz]$ is not thin in $K$; 
that is, $K$ is not $\Cat{}{0}$.

\parit{``If'' part.}
Since $K$ is simply connected,
by Globalization theorem \ref{thm:hadamard-cartan} 
it suffices to show that any point $p\in K$ admits a $\Cat{}{0}$ neighborhood.

If $p\in\Int K$ then it admits a neighborhood isometric to a subset of $\EE^m$. Hence the statement follows.

Fix $p\in S$.
Assume that $k_2(p)>0$.
Fix sufficiently small $\eps>0$ and set $K'=K\cap \cBall[p,\eps]$.
Let us show that 
\begin{clm}{}\label{K'-is-CAT}
$K'$ is a $\Cat{}{0}$ space.
\end{clm}

Consider the coordinate system with the origin at $p$
and the principle directions and $\nu(p)$ as the coordinate directions.
For small $\eps>0$, the set $K'$ 
can be described as a subgraph
\[K'
=
\set
{(x_1,\dots,x_m)\in \cBall[p,\eps]}
{x_m\le f(x_1,\dots,x_{m-1}}.\]
Moreover, since $\eps$ is small and $k_2(p)>0$, 
for any fixed $s\in[-\eps,\eps]$ the function 
\[(x_2,\dots,x_{m-1})\mapsto f(s,x_2,\dots,x_{m-1})\]
is concave for $|x_i|<2\cdot\eps$ for each $i$

Fix a negative real value $\lambda<k_1(p)$.
Given $s\in (-\eps,\eps)$,
consider the set 
\[V_s
=
\set
{(x_1,\dots,x_m)\in K'}
{x_m\le f(x_1,\dots,x_{m-1})+\lambda\cdot (x_1-s)^2}.\]
Note that the function 
\[(x_1,\dots, x_{m-1})\mapsto f(x_1,\dots,x_{m-1})+\lambda\cdot (x_1-s)^2\]
is concave near the origin.
Since $\eps$ is small, we can assume that $V_s$ forms a convex set in $\EE^m$ for any $s$.

Further note that 
\[K'=\bigcup_{s\in[-\eps,\eps]}V_s\]
and
\begin{clm}{}\label{eq:VcVnV}
If $a<b<c$ then $V_b\supset V_a\cap V_c$.
\end{clm}

Given an array of values $s^1<\dots<s^\kay$ in $[-\eps,\eps]$,
set $V^i=V_{s^i}$ and
consider the unions 
\[W^i=V^1\cup\dots\cup V^i\]
equipped with the induced length metric.

\begin{center}
\begin{lpic}[t(1mm),b(1mm),r(0mm),l(0mm)]{pics/K_s(1)}
\lbl{6,18;{\color{white}$V^1$}}
\lbl{26,17;{\color{white}$\dots$}}
\lbl{48,18;{\color{white}$V^\kay$}}
\end{lpic}
\end{center}

Note that the array $(s^n)$ can be chosen in such a way that 
$W^\kay$ is arbitrarily close to $K'$.

By Proposition~\ref{prop:cat-limit}, 
in order to prove \ref{K'-is-CAT}, 
it is sufficient to show the following.
\begin{clm}{}
All $W^i$ form $\Cat{}{0}$ spaces.
\end{clm}

This claim is proved by induction.
Base: $W^1=V^1$ is $\Cat{}{0}$ as a convex subset in $\EE^m$.

\parit{Step:} Assume that $W^i$ is $\Cat{}{0}$.
According to \ref{eq:VcVnV}
\[V^{i+1}\cap W^i=V^{i+1}\cap V^i.\] 
Moreover, this set forms a convex set in $\EE^m$ 
and therefore it is a convex set in $W^i$ and in $V^{i+1}$.
By Reshetnyak's gluing theorem, $W^{i+1}$ is $\Cat{}{0}$.
Hence the claim follows.
\claimqeds

Note that we have  proved the following
\begin{clm}{}\label{clm-strong2convex}
$K$ is a $\Cat{}{0}$ space if $K$ is 
\index{strongly two-convex set}\emph{strongly two-convex},
that is, $k_2(p)>0$ at any point $p\in S$.
\end{clm}


It remains to show that $p$ admits a $\Cat{}{0}$ neighborhood in the case $k_2(p)=0$.

Choose a coordinate system $(x_1,\dots,x_m)$ as above,
so that the $(x_1,\dots,x_{m-1})$-coordinate hyperplane is the tangent subspace to $S$ at $p$.

Fix $\eps>0$ so that a neighborhood of $p$ in $S$ 
is the graph
\[x_m= f(x_1,\dots,x_{m-1})\]
of a function $f$ defined on the open ball $B$ of radius $\eps$  centered at the origin in the $(x_1,\dots,x_{m-1})$-hyperplane.
Fix a smooth positive strongly convex function $\phi\:B\to \RR_+$
such that $\phi(x)\to\infty$ as $x$ approaches the boundary $B$.
Note that for $\delta>0$, the subgraph $K_\delta$ defined by the inequality
\[x_m\le f(x_1,\dots,x_{m-1})-\delta\cdot\phi(x_1,\dots,x_{m-1})\]
is strongly two-convex.
By \ref{clm-strong2convex}, $K_\delta$ is $\Cat{}{0}$.

Finally as $\delta\to0$, the closed $\eps$-neighborhoods of $p$ in $K_\delta$ 
converge to the closed $\eps$-neighborhood of $p$ in $K$.
That is, $\eps$-neighborhoods of $p$ are $\Cat{}{0}$.
\qeds



\section{Open plane sets}

In this section we  consider inheritance of upper curvature bounds by subsets of the Euclidean plane.

\begin{thm}{Theorem}\label{thm:bishop-plane}
Let $\Omega$ be an open simply connected subset of $\EE^2$.
Equip $\Omega$ with its induced length metric and denote its completion 
by $K$.
Then $K$ is $\Cat{}{0}$.
\end{thm}

The assumption that the set $\Omega$ is open is not critical;
instead one can assume that the induced length metric takes finite values at all points of $\Omega$.
We sketch the proof from the note \cite{bishop:jordan} by Richard Bishop and suggest that  the details be finished as an exercise.
A generalization of this result is proved by 
Alexander Lytchak and Stefan Wenger
\cite[Proposition 12.1]{lytchak-wenger};
this paper also contains a far leading application.

%???Sasha suggests to include exercise
%If in a prper length space all simple triangles are thin then all triangles are thin.
%Here simple triangle is triangle which sides intesect only at the common vertices.
%This exercise might go naturally into the section on thin triangles, or might stay here...


\parit{Sketch of proof.}
It is sufficient to show that any triangle in $K$ is thin,
as defined in \ref{def:k-thin}.

Note that $K$ admits a length-preserving map to $\EE^2$ which extends the embedding $\Omega\hookrightarrow\EE^2$.
Therefore each triangle $[xyz]$ in $K$ can be mapped to the plane in a length-preserving way.
Since $\Omega$ is simply connected, any open region, say $\Delta$, that is surrounded by the image of $[xyz]$ lies completely in $\Omega$.

\begin{wrapfigure}{r}{26mm}
\begin{lpic}[t(-0mm),b(0mm),r(0mm),l(0mm)]{pics/bishop-triangle(1)}
\end{lpic}
\end{wrapfigure}

Note that in each triangle $[xyz]$ in $K$, the sides $[xy]$, $[yz]$ and $[zx]$ intersect each other along a geodesic starting at a common vertex, possibly a one-point geodesic.
In other words, every triangle in $K$ looks like the one in the diagram. 

Indeed, assuming the contrary, there will be a diangle in $K$,
that is, two minimizing geodesics with common ends but no other common points.
The image of this diangle in the plane must bound an open region of $\Omega$ and both sides of the region must be concave in the plane, since otherwise one could shorten the sides by pushing them into $\Omega$.
Evidently, there is no such plane diangle with concave sides, a contradiction.

Note that it is enough to consider only injective triangles $[xyz]$, 
that is, triangle whose sides $[xy]$, $[yz]$ and $[zx]$ intersect each other only at the common vertices.
If this is not the case, chopping the overlapping part of sides reduces to the injective case.

Again, the open region, say $\Delta$, bounded by the image of $[xyz]$  has concave sides in the plane, since otherwise one could shorten the sides by pushing them into $\Omega$.
It remains to solve the exercise below.
\qeds

\begin{thm}{Exercise}\label{ex:concave-triangle}
Assume $S$ is a closed plane 
region whose boundary is a triangle $T$ with concave sides  in the plane.
Equip $S$ with the induced length metric.
Show that the triangle $T$ is thin in $S$.
\end{thm}



Here is a spherical analog of Theorem \ref{thm:bishop-plane},
which can be proved along the same lines.
It will be used in the next section. 

\begin{thm}{Exercise}\label{ex:bishop-sphere}
Let $\Theta$ be an open connected subset of the unit sphere $\SS^2$ which does not contain a closed hemisphere.
Equip $\Theta$ with the induced length metric.
Let $\tilde \Theta$ be a metric covering of $\Theta$ 
such that any closed curve in $\tilde \Theta$ of length smaller than $2\cdot\pi$ is contractible.

Show that the completion of $\tilde \Theta$ is a  $\Cat{}{1}$ space.
\end{thm}

\section{Open space sets}
The material below was inspired by work of Samuel Shefel.
%, and developed by Anton Petrunin \cite{petrunin-shefel}.
% There is a ref to my paper with Stadler in the end of the chapter.

Shefel seems very intrigued by the survival of metric properties under affine transformation.
%???Sasha says it is not English --- I am not sure, is it better to writ in the past since Shefel is dead???
To describe an instance of such phenomena,
note that two-convexity survives under affine transformations of a Euclidean space.
Therefore, as a consequence of Theorem~\ref{thm:set-with-smooth-bry:CBA}, the following holds.

\begin{thm}{Corollary}
Let $K$ be closed connected subset of Euclidean space 
equipped with the induced length metric.
Assume $K$ is bounded by a smooth hypersurface and  is a $\Cat{}{0}$ space. 
Then any affine transformation of $K$ is also $\Cat{}{0}$.
\end{thm}

By Corollary~\ref{cor:shefel}, an analogous statement holds for sets bounded by Lipschitz surfaces in the three-dimensional Euclidean space.
In higher dimensions this is no longer true, 
see Exercise~\ref{ex:two-convex-not-a-CAT}.

Here is the main theorem of this section.

\begin{thm}{Shefel's Theorem}\label{thm:shefel}
Let $\Omega$ be a connected open set in $\EE^3$.
Equip $\Omega$ with the induced length metric
and denote by $K$ the completion of the universal metric cover of $\Omega$.
Then $K$ is a $\Cat{}0$ space  
if and only if $\Omega$ is two-convex.
\end{thm}

The following exercise shows that the analogous statement does not hold in higher dimensions.

\begin{thm}{Exercise}\label{ex:two-planes}
Let $\Pi_1,\Pi_2$ be two planes in $\EE^4$ intersecting at a single point.
Consider the universal cover $K$ of the space obtained by infinitely branching $\EE^4$ along $\Pi_1$ and $\Pi_2$, and equip $K$ with the induced length metric.

Show that 
$K$ is a $\Cat{}{0}$ space if and only if $\Pi_1\perp\Pi_2$.

\end{thm}

Before coming to the proof of Shefel's theorem, 
let us formulate a few corollaries.
The following corollary is a generalization of Theorem \ref{thm:set-with-smooth-bry:CBA} for  three-dimensional Euclidean space.

\begin{thm}{Corollary}\label{cor:shefel}
Let $K$ be a closed subset in $\EE^3$ 
bounded by a Lipschitz hypersurface.
Then $K$ with the induced length metric is a $\Cat{}0$ space  
if and only if the interior of $K$ is two-convex and simply connected.
\end{thm}

\parit{Proof.}
Set $\Omega=\Int K$.
Since $K$ is simply connected and bounded by a surface, 
$\Omega$ is also simply connected.

Apply Shefel's Theorem to $\Omega$.
Note that the completion of $\Omega$ equipped with the induced length metric 
is isometric to $K$ with the induced length metric.
Hence the result follows.
\qeds

The following corollary is the main statement in Shefel's original paper \cite{shefel-3D}.
In order to formulate it, we need yet one  more definition.

Let $U$ be an open set in $\RR^2$.
A continuous function $f\:U\to\RR$ is called 
\index{saddle function}\emph{saddle} 
if for any linear function $\ell\:\RR^2\to\RR$ the difference 
$f-\ell$
does not have local maxima or local minima in $U$.
Equivalently, the open subgraph and epigraph of $f$ 
\begin{align*}
&\set{(x,y,z)\in\EE^3}{z<f(x,y),\ (x,y)\in U},
\\
&\set{(x,y,z)\in\EE^3}{z>f(x,y),\ (x,y)\in U}
\end{align*}
are two-convex. 

\begin{thm}{Corollary}
Let $f\:\DD\to \RR$ be a Lipschitz function which is saddle in the interior of the closed unit disc $\DD$. 
Then the graph
\[\Gamma=\set{(x,y,z)\in \EE^3}{z=f(x,y)},\] 
equipped with induced length metric is a $\Cat{}{0}$ space.
\end{thm}

\parit{Proof.}
Since the function $f$ is Lipschitz,
its  graph $\Gamma$ with the induced length metric is bi-Lipschitz to the Euclidean metric on $\DD$.

Consider the sequence of sets 
\[K_n
=
\set{(x,y,z)\in \EE^3}{z\lege f(x,y)\pm\tfrac1n,\ (x,y)\in \DD}.\]
Note that each $K_n$ is closed, simply connected.
Directly from definition, it follows that $K$ is also two-convex. 
%%%???please check English and remove this note
Moreover the boundary of $K_n$ forms a Lipschitz surface.

Equip $K_n$ with the induced length metric.
By Corollary~\ref{cor:shefel},
$K_n$ is a $\Cat{}{0}$ space.
It remains to note that as $n\to\infty$ the sequence of space $K_n$ converges to $\Gamma$ in the sense of Gromov--Hausdorff and apply Proposition~\ref{prop:cat-limit}.
\qeds

Now we are back to the proof of Shefel's theorem \ref{thm:shefel}.

Recall, that a subset $P$ of $\EE^m$ is called a \index{polytope}\emph{polytope} 
if it can be presented as a union of a  finite number of simplices.
Similarly,
a \index{spherical polytope}\emph{spherical polytope}
is a union of a  finite number of simplices in $\mathbb{S}^m$.

\begin{wrapfigure}{r}{29mm}
\begin{lpic}[t(-0mm),b(0mm),r(0mm),l(0mm)]{pics/polytope(1)}
\end{lpic}
\end{wrapfigure}

Note that any polytope admits a finite triangulation.
Therefore any polytope equipped with the induced length metric 
forms a Euclidean polyhedral space as defined in \ref{def:poly}.

Let $P$ be a polytope and $\Omega$ its interior,
both considered with the induced length metrics.
Typically, the completion $K$ of $\Omega$ 
is isometric to $P$.
However in general
we only have a locally distance preserving map $K\to P$;
it does not have to be onto and it may be not injective. 
An example can be guessed from the picture.
Nevertheless, is easy to see that $K$ is always a polyhedral space.
 
\begin{thm}{Lemma}\label{lem:poly-shefel}
Shefel's Theorem~\ref{thm:shefel} holds if the set $\Omega$ is the interior of a polytope.
\end{thm}

The statement might look obvious, but there is a hidden obstacle in the proof. %there is an underwater stone in the proof. 
The proof uses the following exercises.

\begin{thm}{Exercise}\label{ex:hemisphere}
Show that any closed path of length $<2\cdot \pi$  in the units sphere $\SS^2$ lies in an open  hemisphere. 
\end{thm}

\begin{thm}{Exercise}\label{ex:inner-support}
Assume $\Omega$ is an open subset in $\EE^3$
which is not two-convex.
Show that there is a plane $W$ such that the complement 
$W\backslash \Omega$ contains an isolated point.
\end{thm}

\parit{Proof of Lemma~\ref{lem:poly-shefel}.}
The ``only if'' part can be proved in the same way as in Theorem~\ref{thm:set-with-smooth-bry:CBA} with additional use of Exercise~\ref{ex:inner-support}.


\parit{``If'' part.}
Assume that $\Omega$ is two-convex.
Denote by $\tilde\Omega$ the universal metric cover of $\Omega$.
Let $\tilde K$ and $K$ be the completions of $\tilde\Omega$ and  $\Omega$ correspondingly.

The main step is to show that $\tilde K$ is $\Cat{}{0}$. 

Note that $K$ is a polyhedral space and the covering $\tilde\Omega\to\Omega$ extends to a covering map $\tilde K\to K$ which might be branching at some vertices.
For example, if \[K=\set{(x,y,z)\in\EE^3}{|z|\le |x|+|y|\le 1}\] and $p$ is the origin then $\Sigma_p$,
the space of directions at $p$,
is not simply connected and $\tilde K\to K$ branches at $p$.


Fix a point $\tilde p\in \tilde K\backslash\tilde\Omega$; 
denote by $p$ the image of $\tilde p$ in $K$.
By Globalization theorem (\ref{thm:hadamard-cartan}) it is sufficient to show that 

\begin{clm}{}\label{eq:curv=<0}
A small neighborhood of $\tilde p$ in $\tilde K$ is $\Cat{}{0}$.
\end{clm}

Recall that $\Sigma_{\tilde p}=\Sigma_{\tilde p}\tilde K$ denotes the space of directions at $\tilde p$.
Note that a small neighborhood of $\tilde p$ in $\tilde K$
is isometric to an open set in the cone over $\Sigma_{\tilde p}\tilde K$.
By Exercise~\ref{ex:cone+susp}, \ref{eq:curv=<0} follows once we can show that

\begin{clm}{}\label{eq:curv=<1}
$\Sigma_{\tilde p}$ is $\Cat{}{1}$.
\end{clm}

By  rescaling, we can assume that every face of $K$ which does not contain $p$ lies at distance at least 2 from $p$.
Denote by $\SS^2$ the unit sphere centered at $p$,
set $\Theta=\SS^2\cap\Omega$.
Note that $\Sigma_pK$ is isometric to the completion of $\Theta$
and $\Sigma_{\tilde p}\tilde K$ is the completion of the regular metric covering $\tilde\Theta$ of $\Theta$  induced by the universal metric cover $\tilde \Omega\to \Omega$.

By Exercise \ref{ex:bishop-sphere}, it remains to show  the following.
\begin{clm}{}
Any closed curve in $\tilde\Theta$ of length less than $2\cdot\pi$ is contractible.
\end{clm}

Fix a closed curve $\tilde \gamma$ of length $<2\cdot\pi$ in $\tilde\Theta$.
Its projection $\gamma$ in $\Theta\subset\SS^2$ has the same length.
Therefore, by Exercise~\ref{ex:hemisphere}, $\gamma$ lies in an open hemisphere.
Then for a plane $\Pi$ almost passing through $p$,
the central projection $\gamma'$ of $\gamma$ to $\Pi$ is defined and lies in $\Omega$. 
Moreover, it is contractible in $\Omega$.
From two-convexity of $\Omega$
and Proposition~\ref{prop:3d-strong-2-convexity},
the curve $\gamma'$ is contractible in $\Pi\cap \Omega$.


It follows that $\gamma$ is contractible in $\Theta$ 
and therefore $\tilde\gamma$ is contractible in $\tilde\Theta$.
\qeds

The following proposition 
describes a construction which was essentially given by Samuel Shefel in \cite{shefel-3D}.
It produces $\Conv_2 \Omega$ for an open set $\Omega\subset\EE^3$.

\begin{thm}{Proposition}\label{prop:2-conv-construction}
Let $\Pi_1,\Pi_2\dots$ be an everywhere dense
sequence of planes in $\EE^3$.
Given an open set $\Omega$, consider 
the recursively  defined sequence of open sets 
$\Omega=\Omega_0\subset\Omega_1\subset\dots$ 
such that 
$\Omega_n$ is the union of $\Omega_{n-1}$ 
and all the bounded components of 
$\EE^3\backslash(\Pi_n\cup \Omega_{n-1})$.
Then 
\[\Conv_2\Omega=\bigcup_n\Omega_n.\]

\end{thm}

\parit{Proof.}
Set 
\[\Omega'=\bigcup_n\Omega_n.\eqlbl{eq:Omega'}\]
Note that $\Omega'$ is a union of open sets, in particular it is open.

Let us first show that  
\[\Conv_2\Omega\supset\Omega'.\eqlbl{eq:Conv2>Omega'}\]  
Suppose we already know that  $\Conv_2\Omega\supset\Omega_{n-1}$. 
Fix a bounded component  $U$ of $\EE^3\backslash(\Pi_n\cup \Omega_{n-1})$.
Assume its boundary intersects $\Pi_{n}$ in
a bounded component $\hat U$ of $\Pi_{n}\backslash \Omega_{n-1}$. 
Then there is a curve $\gamma$ in 
$W\z=\Pi_{n}$ 
encircling  $\hat U$ and contractible in $\Omega_{n-1}$. Hence $\hat U$ must be entirely contained in $\Conv_2\Omega$ by two-convexity of  $\Conv_2\Omega$. 
Applying the same argument to planes parallel to $W$ we see that all of $U$ must lie in $\Conv_2\Omega$. 

In general, the boundary of $U$ may not intersect $\Pi_n$.
(This may happen only on the first step --- in the construction of $\Omega_1$ from $\Omega_0$, but we do not use it.)
In this case one has to apply the same argument for a plane $W$ supporting the closure of $U$ at one point.


By induction, $\Conv_2\Omega\supset\Omega_n$ for each $n$.
Therefore \ref{eq:Omega'} implies \ref{eq:Conv2>Omega'}.

It remains to show that $\Omega'$ is two-convex.
Assume the contrary; 
that is, there is a plane $\Pi$ 
and a simple closed curve $\gamma\:\SS^1\to \Pi\cap \Omega'$ 
which is null-homotopic in $\Omega'$,
but not null-homotopic in $\Pi\cap\Omega'$.

By approximation we can assume that $\Pi=\Pi_n$ for a large enough  $n$ 
and that $\gamma$ lies in $\Omega_{n-1}$.
The latter contradicts the $n$-th step in the construction. 
\qeds



\begin{thm}{Key lemma}\label{lem:key-shefel}
The two-convex hull of the interior of a polytope in $\EE^3$
is also the interior of a polytope.
\end{thm}

\parit{Proof.}
Fix a polytope $P$ in $\EE^3$.
Set $\Omega=\Int P$.  We may assume that  $\Omega$ is dense in $P$.
Denote by $F_1,\dots,F_m$ the facets 
(2-faces)
of $P$. By subdividing $F_i$ if necessary, we may assume that all $F_i$ are convex.

Set $\Omega'=\Conv_2\Omega$ and let $P'$ be the closure of $\Omega'$.
Further, 
for each $i$, 
set $F'_i=F_i\backslash \Omega'$.
In other words, 
$F'_i$ is the subset of the facet $F_i$ 
which remains on the boundary of $P'$.

From the construction of the two-convex hull (\ref{prop:2-conv-construction}) we get

\begin{clm}{}\label{clm:F'-convex}
$F'_i$ is  a convex subset of $F_i$.
\end{clm}

Further, since $\Omega'$ is two-convex,
we get the following.

\begin{clm}{}\label{clm:complement-of-F'-convex}
Each connected component of the complement $F_i\backslash F'_i$ is convex.
\end{clm}

\begin{wrapfigure}{r}{25mm}
\begin{lpic}[t(-0mm),b(0mm),r(0mm),l(0mm)]{pics/shefel-face(1)}
\lbl{5,21;$A$}
\lbl{13,11;$F'$}
\lbl[lt]{17,28;$\ell$}
\end{lpic}
\end{wrapfigure}

Indeed, assume a connected component $A$ of $F_i\backslash F'_i$ fails to be convex.
Then there is a supporting line $\ell$ to $F'_i$ touching $F'_i$ at a single point in the interior of $F_i$.
Then one could rotate the plane of $F_i$ slightly around $\ell$ and move it parallel to cut a ``cap'' from the complement of $\Omega$.  
The latter means that $\Omega$ is not two-convex, 
a contradiction.
\claimqeds

From \ref{clm:F'-convex} and \ref{clm:complement-of-F'-convex}, we get that 

\begin{clm}{}$F'_i$ is a convex polygon for each $i$.
\end{clm}

Consider the complement 
$\EE^3\backslash \Omega$ 
equipped with the length metric.
By construction of the two-convex hull (\ref{prop:2-conv-construction}), 
the complement $L=\EE^3\backslash (\Omega'\cup P)$
is locally convex;
that is, any point of $L$ admits a convex neighborhood.

Summarizing: (1)
$\Omega'$ is a two-convex open set,
(2) the boundary $\partial\Omega'$ 
contains a finite number of polygons $F_i'$
and the remaining part is locally concave.
It remains to show that (1) and (2) imply that $\partial\Omega'$
is piecewise linear.

\begin{thm}{Exercise}\label{ex:convex+saddle+broken=>PL}
Prove the last statement.\qeds
\end{thm}


\parit{Proof of \ref{thm:shefel}.}
The ``only if'' part can be proved the same way as in Theorem~\ref{thm:set-with-smooth-bry:CBA} with additional use of Exercise~\ref{ex:inner-support}.

\parit{``If''-part.}
Suppose $\Omega$ is two-convex. 
We need to show that $K$ is $\Cat{}{0}$.

Note that it is sufficient to show that
$\Cat{}{0}$ comparison holds for any
4 points $x^1,x^2,x^3,x^4\in\Omega$.

Fix $\eps>0$.
Choose six broken lines connecting all the pairs of points $x^1,x^2,x^3,x^4$ such that length of each  broken line is at most $\eps$ bigger than 
the distance between its ends in the length metric on $\Omega$.
Choose a polytope $P$ 
in $\Omega$ such that the interior $\Int P$ is simply connected 
and  it contains all these six broken lines.

Denote by $\Omega'$ the two-convex hull of the interior of $P$.
According to Key Lemma (\ref{lem:key-shefel}) $\Omega'$ is the interior of a polytope.

Equip $\Omega'$ with the induced length metric.
Consider the universal metric cover $\tilde\Omega'$ of $\Omega'$.
(The covering $\tilde\Omega'\to\Omega'$ might be nontrivial;
even though $\Int P$ is simply connected, its two-convex hull $\Omega'$ might be not simply connected.)
Denote by $\tilde K'$ the completion of $\tilde\Omega'$.

By Lemma~\ref{lem:poly-shefel}, $\tilde K'$ is $\Cat{}0$.

Since $\Int P$ is simply connected, the embedding $\Int P\hookrightarrow \Omega'$
admits a lifting $\iota\:\Int P\hookrightarrow \tilde K'$.
By construction, $\iota$ almost preserves the distances between the points $x^1,x^2,x^3,x^4$;
namely 
\begin{align*}
\dist{\iota(x^i)}{\iota(x^j)}{L}\gele \dist{x^i}{x^j}{\Int P}\pm\eps.
\end{align*}

Since $\eps>0$ is arbitrary and $\Cat{}{0}$ comparison holds in $\tilde K'$,
we get that $\Cat{}{0}$ comparison holds in $\Omega$ for $x^1,x^2,x^3,x^4$.

The statement follows since the quadruple $x^1,x^2,x^3,x^4\in\Omega$ is arbitrary.
\qeds

\begin{thm}{Exercise}\label{ex:CAT=>two-convex}
Assume $K\subset\EE^m$ is a closed set bounded by a Lipschitz hypersurface.
Equip $K$ with the induced length metric.
Show that if $K$ is $\Cat{}{0}$ then $K$ is two-convex.
\end{thm}

The following exercise is analogous to Exercise~\ref{ex:two-planes}.
It provides a counterexample to the analog of Corollary~\ref{cor:shefel} in higher dimensions.


\begin{thm}{Exercise}\label{ex:two-convex-not-a-CAT}
Let $K=W\cap W'$, where 
\[W=\set{(x,y,z,t)\in \EE^4}{z\ge -x^2}\]
and $W'=\iota(W)$ for some motion $\iota\:\EE^4\to\EE^4$.

Show that $K$ is always two-convex and one can choose $\iota$ so that $K$  with the induced length metric is not $\Cat{}{0}$.
\end{thm}

\begin{thm}{Exercise}\label{ex:branching-cover} 
Let $\spc{U}$ be a $\Cat{}{0}$ proper length space.
Assume $\tilde{\spc{U}}\to \spc{U}$ is a metric  double covering branching along a geodesic.
Show that $\tilde{\spc{U}}$ is a $\Cat{}{0}$ space.
\end{thm}







\section{Comments and open problems}

In \cite{a-b-b:CBA-m-w-b} Stephanie Alexander, David Berg and Richard Bishop gave the exact upper bound on Alexandrov's curvature for the Riemannian manifolds with boundary.
Namely they show the following.

\begin{thm}{Theorem}
Let $M$ be a Riemannian manifold with boundary $\partial M$.
A direction tangent to the boundary will be called concave if there is a short geodesic in this direction which leaves the boundary and goes into the interior of $M$.
A sectional direction (that is, a 2-plane) 
tangent to the boundary 
will be called \emph{concave} if all the directions in it are concave.

Denote by $\kappa$ an upper bound of sectional curvatures of $M$ and  
sectional curvatures of $\partial M$ in the concave sectional directions. 
Then $M$ is locally $\Cat{}{\kappa}$. 
\end{thm}

\begin{thm}{Corollary}
Let $M$ be a Riemannian manifold with boundary $\partial M$. 
Assume all the sectional curvatures of $M$ and $\partial M$ are bounded from above by $\kappa$.
Then $M$ is locally $\Cat{}{\kappa}$.
\end{thm}

Two-convex sets could be defined using homology instead of homotopy, as in the formulation of Leftschetz theorem in \cite[\S\textonehalf]{gromov:SaGMC}.

Namely, we can say that $K$ is two-convex if the following condition holds: if a 1-dimensional cycle $z$ has support in the intersection of $K$ with a plane $W$ and bound in $K$ then it bounds in $K\cap W$.

The resulting definition is equivalent to the one used above.
 But unlike our definition it can be generalized to define $k$-convex sets in $\EE^m$ for $k>2$.
With this homological definition one can also avoid the use of Papakyriakopoulos' Loop theorem, whose proof is quite involved.
Nevertheless, we chose the definition using homotopies  since it is easier to visualize.

We use our definition only to the open sets, for general sets it would be more natural to use \v{C}ech cohomoly instead. 

If a surface $S$ in $\EE^3$ forms a two-convex set 
then it regarded as a \emph{saddle surface}.
In other words $S$ is saddle if each connected component which any plane cuts from $S$ contains a point on the boundary of $S$ or goes to infinity.  

\begin{thm}{Shefel's conjecture}
Any saddle surface in $\EE^3$ equipped with the length-metric is locally $\Cat{}{0}$.
\end{thm} 

The conjecture is open even for surfaces peresented by a bi-Lipschitz embedding of the disc.

From Corollary \ref{cor:shefel}, it follows that if there is a counterexample, then an arbitrary neighborhood of some point on the surface can not be presented as a graph in any coordinate system.

Further, from the proof of Corollary \ref{cor:shefel},
it follows that if a two-convex set $S$ can be presented as an intersection of a nested sequence of simply connected open two-convex sets then $S$ equipped with the length-metric is locally $\Cat{}{0}$.

So far there is no known examples 
of saddle surfaces which can not be presented this way.
If an example of such surface $S$ would exist, 
then it should have a point $p$ in its interior 
and an open set $\Omega$ such that 
for any  $\eps>0$, we have
\[\Omega\subset\Conv_2[\Omega\cup \oBall(p,\eps)].\]


We say that a surface $S$ in a metric space $\spc{X}$ is saddle if for any convex function $f\:\spc{X}\to\RR$,
the restriction $f|_S$ has no local maxima in the interior of $S$.

\begin{thm}{Generalized Shefel's  conjecture}
A saddle surface in a $\Cat{}{\kappa}$ space, 
equipped with the length-metric, is locally $\Cat{}{\kappa}$.
\end{thm}

A subset $K$ is called strongly two-convex if any null-homotopic circle $\gamma\:\SS^1\to K$ is also null-homotopic in $K\cap \Conv[\gamma(\SS^1)]$.

\begin{thm}{Question}
Is it true that any closed strongly two-convex set with dense interior bounded by a Lipschitz hypersurface in $\EE^m$ forms a $\Cat{}{0}$ space? 
\end{thm}

For more on the subject, read \cite{petrunin-metricmin} and \cite{petrunin-stadler} by Anton Petrunin and Stephan Stadler.

